<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.kej.app.board.mapper.MusicBoardMapper">
  	
  	<!-- 전체 목록 조회 -->
  	<select id="musicBoardAllList" resultType="BoardVO">
  		SELECT b.BOARD_NO
		     , id
		     , title 
		     , write_dt  
		     , view_count
		     , code
		     , (SELECT count(*)
		  		  FROM reply r
		  		 WHERE yn = 1
		  		   AND b.board_no = r.board_no
				   AND r.yn = 1
		  	   ) AS reply_count
	     FROM board b
	    WHERE b.yn = 1
	      AND code = #{code}
	      AND category LIKE CONCAT('%', #{category}, '%')
	    LIMIT #{amount}
  	</select>
  	
  	
  </mapper>